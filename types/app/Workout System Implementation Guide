# üöÄ Workout System Implementation Guide

## Quick Start (5 Minutes)

Follow these steps to integrate the complete workout system into your Daily Deposits app.

---

## Step 1: Copy Files to Your Project

### 1.1 Type Definitions
```bash
# Copy to your project
cp types/workout.d.ts <your-project>/types/
```

### 1.2 Validation Schemas
```bash
cp schemas/workout.ts <your-project>/schemas/
```

### 1.3 Redux Slice
```bash
cp state/slices/workoutSlice.ts <your-project>/state/slices/
```

### 1.4 Screen Components
```bash
# Copy all workout screens
cp app/(tabs)/workouts.tsx <your-project>/app/(tabs)/
cp app/(tabs)/active-workout.tsx <your-project>/app/(tabs)/
cp app/exercise-library.tsx <your-project>/app/
cp app/create-workout.tsx <your-project>/app/
cp app/progress.tsx <your-project>/app/
```

---

## Step 2: Update Redux Store

Add the workout slice to your store configuration:

```typescript
// state/store.ts
import { configureStore } from '@reduxjs/toolkit'
import { persistStore, persistReducer } from 'redux-persist'
import authReducer from './slices/authSlice'
import preferencesReducer from './slices/preferencesSlice'
import workoutReducer from './slices/workoutSlice' // ADD THIS

// Persist config for workout data
const workoutPersistConfig = {
  key: 'workout',
  storage: securePersistStorage,
  whitelist: ['workouts', 'customExercises', 'preferences', 'personalRecords'],
}

const persistedWorkoutReducer = persistReducer(
  workoutPersistConfig,
  workoutReducer
)

export const store = configureStore({
  reducer: {
    auth: authReducer,
    preferences: preferencesReducer,
    workout: persistedWorkoutReducer, // ADD THIS
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware({
      serializableCheck: {
        ignoredActions: ['persist/PERSIST', 'persist/REHYDRATE'],
      },
    }),
})

export const persistor = persistStore(store)
export type RootState = ReturnType<typeof store.getState>
export type AppDispatch = typeof store.dispatch
```

---

## Step 3: Add Workout Tab to Navigation

Update your tab layout to include the workouts tab:

```typescript
// app/(tabs)/_layout.tsx
import { Tabs } from 'expo-router'

export default function TabLayout() {
  return (
    <Tabs
      screenOptions={{
        headerShown: false,
        tabBarStyle: {
          backgroundColor: '#1F2937', // dark-700
          borderTopColor: '#374151', // dark-50
        },
        tabBarActiveTintColor: '#10B981', // primary-500
        tabBarInactiveTintColor: '#6B7280', // dark-700
      }}
    >
      <Tabs.Screen
        name="index"
        options={{
          title: 'Home',
          tabBarIcon: ({ color }) => <Text style={{ color }}>üè†</Text>,
        }}
      />
      
      <Tabs.Screen
        name="workouts"
        options={{
          title: 'Workouts',
          tabBarIcon: ({ color }) => <Text style={{ color }}>üí™</Text>,
        }}
      />
      
      <Tabs.Screen
        name="profile"
        options={{
          title: 'Profile',
          tabBarIcon: ({ color }) => <Text style={{ color }}>üë§</Text>,
        }}
      />
    </Tabs>
  )
}
```

---

## Step 4: Register Modal/Full-Screen Routes

Add workout screens to your root layout:

```typescript
// app/_layout.tsx
import { Stack } from 'expo-router'
import { Provider } from 'react-redux'
import { PersistGate } from 'redux-persist/integration/react'
import { store, persistor } from '@/state/store'

export default function RootLayout() {
  return (
    <Provider store={store}>
      <PersistGate loading={null} persistor={persistor}>
        <Stack>
          <Stack.Screen name="(tabs)" options={{ headerShown: false }} />
          
          {/* Workout Screens */}
          <Stack.Screen 
            name="active-workout" 
            options={{ 
              presentation: 'fullScreenModal',
              headerShown: false,
            }} 
          />
          <Stack.Screen 
            name="exercise-library" 
            options={{ 
              presentation: 'modal',
              headerShown: false,
            }} 
          />
          <Stack.Screen 
            name="create-workout" 
            options={{ 
              presentation: 'modal',
              headerShown: false,
            }} 
          />
          <Stack.Screen 
            name="progress" 
            options={{ 
              presentation: 'modal',
              headerShown: false,
            }} 
          />
        </Stack>
      </PersistGate>
    </Provider>
  )
}
```

---

## Step 5: Test the Implementation

### 5.1 Start Your Dev Server
```bash
npm start
```

### 5.2 Test Basic Flow
1. ‚úÖ Navigate to **Workouts** tab
2. ‚úÖ Browse workout templates
3. ‚úÖ Click "Start Workout" on any template
4. ‚úÖ Log a few sets (enter weight/reps, click Complete Set)
5. ‚úÖ Watch rest timer auto-start
6. ‚úÖ Navigate between exercises
7. ‚úÖ Complete workout
8. ‚úÖ Check workout in History tab

### 5.3 Test Exercise Library
1. ‚úÖ Open exercise library
2. ‚úÖ Search for exercises
3. ‚úÖ Filter by muscle group
4. ‚úÖ View exercise details

### 5.4 Test Workout Creation
1. ‚úÖ Click + button in Workouts
2. ‚úÖ Add workout name
3. ‚úÖ Add exercises
4. ‚úÖ Configure sets/reps
5. ‚úÖ Start workout immediately

---

## Step 6: Customize to Your Brand

### 6.1 Update Colors (Optional)
The system uses your existing Tailwind config:
- `primary-500` (green) for highlights
- `dark-700` for cards
- `dark-900` for backgrounds

If you want different colors, update:
```javascript
// tailwind.config.js
module.exports = {
  theme: {
    extend: {
      colors: {
        primary: {
          500: '#10B981', // Change this to your brand color
        },
      },
    },
  },
}
```

### 6.2 Adjust Rest Timer Defaults
```typescript
// In workoutSlice.ts, update initialState:
preferences: {
  defaultRestTime: 60,      // Change from 90 to 60 seconds
  autoStartTimer: true,     // Keep auto-start
  timerSound: true,         // Enable sound
  vibrationEnabled: true,   // Enable haptics
}
```

---

## Step 7: Add Sample Data (Optional)

For development/testing, you can seed some data:

```typescript
// In your app startup or onboarding flow
import { setExercises, setWorkouts } from '@/state/slices/workoutSlice'

const sampleExercises = [
  // Copy exercises from exercise-library.tsx
]

const sampleWorkouts = [
  // Copy templates from workouts.tsx
]

dispatch(setExercises(sampleExercises))
dispatch(setWorkouts(sampleWorkouts))
```

---

## Step 8: Configure Persistence (Recommended)

Ensure workout data persists across app restarts:

```typescript
// This should already be set up from Step 2
// But verify your storage adapter works:

// Test in your app:
import { store } from '@/state/store'

console.log('Workout State:', store.getState().workout)
// Should persist after reloading app
```

---

## Troubleshooting

### Issue: TypeScript Errors
**Solution:** Ensure all `.d.ts` files are in the `types/` directory and your `tsconfig.json` includes:
```json
{
  "compilerOptions": {
    "typeRoots": ["./types", "./node_modules/@types"]
  },
  "include": ["**/*.ts", "**/*.tsx", "types/**/*.d.ts"]
}
```

### Issue: Redux State Not Updating
**Solution:** Check Redux DevTools:
```bash
npm install --save-dev @redux-devtools/extension
```

### Issue: Navigation Not Working
**Solution:** Verify Expo Router is properly configured:
```bash
npx expo install expo-router react-native-safe-area-context react-native-screens
```

### Issue: Styles Not Applying
**Solution:** Ensure Tailwind/NativeWind is set up:
```bash
npm install nativewind
npm install --save-dev tailwindcss
```

---

## Next Steps

### Enhance with Backend Integration
```typescript
// Example API integration
import { api } from '@/lib/api'

// Sync workouts to backend
const syncWorkouts = async () => {
  const workouts = store.getState().workout.workouts
  await api.post('/workouts/sync', { workouts })
}

// Load user's workout history
const loadWorkouts = async () => {
  const { data } = await api.get('/workouts')
  dispatch(setWorkouts(data))
}
```

### Add Analytics Tracking
```typescript
import * as Analytics from 'expo-firebase-analytics'

// Track workout completion
Analytics.logEvent('workout_completed', {
  workout_name: workout.name,
  duration: workout.duration,
  exercises: workout.exercises.length,
})
```

### Implement Push Notifications
```typescript
// Remind users to work out
import * as Notifications from 'expo-notifications'

Notifications.scheduleNotificationAsync({
  content: {
    title: "Time to Train! üí™",
    body: "Your workout is waiting!",
  },
  trigger: {
    hour: 18,
    minute: 0,
    repeats: true,
  },
})
```

---

## Performance Checklist

- [ ] Use `React.memo()` on SetRow components
- [ ] Implement `FlatList` for long exercise lists
- [ ] Add loading states for async operations
- [ ] Optimize images with proper sizes
- [ ] Enable Hermes engine (auto in newer Expo)
- [ ] Test on low-end devices

---

## Success Criteria

Your implementation is complete when:
- ‚úÖ Users can start and complete workouts
- ‚úÖ Sets are logged with weight/reps
- ‚úÖ Rest timer works automatically
- ‚úÖ Workout history is saved
- ‚úÖ Exercise library is searchable
- ‚úÖ Custom workouts can be created
- ‚úÖ Progress dashboard shows stats
- ‚úÖ Data persists after app restart

---

## Support & Resources

- **Redux Docs**: https://redux-toolkit.js.org/
- **Zod Docs**: https://zod.dev/
- **Expo Router**: https://docs.expo.dev/router/introduction/
- **NativeWind**: https://www.nativewind.dev/

---

**Ready to ship! üöÄ**

Your fitness app now has a complete, production-ready workout tracking system!
